# Шифр Хилла

**Шифр Хилла** - это [полиграфическая замена](https://en.wikipedia.org/wiki/Polygraphic_substitution) шифр, основанный на линейной алгебре.

Каждая буква представлена числом [по модулю](https://en.wikipedia.org/wiki/Modular_arithmetic) `26`. Хотя это не является существенной особенностью шифра, эта простая схема часто используется:

| **Буква** | A | B | C | D | E | F | G | H | I | J | K | L | M | N | O | P | Q | R | S | T | U | V | W | X | Y | Z |
| ------ | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| **Число** | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 | 15 | 16 | 17 | 18 | 19 | 20 | 21 | 22 | 23 | 24 | 25 |

## Шифрование

Чтобы зашифровать сообщение, каждый блок из `n` букв (рассматриваемый как вектор, состоящий из `n` компонентов) умножается на обратимую матрицу `n × n` по модулю `26`.

Матрица, используемая для шифрования, называется _ключом шифра_, и она должна быть выбрана случайным образом из набора обратимых матриц `n × n` (по модулю `26`). Шифр, конечно, может быть адаптирован к алфавиту с любым количеством букв; все арифметические действия просто должны выполняться по модулю количества букв, а не по модулю `26`.

Рассмотрим сообщение `ACT` и приведенный ниже ключ (или `GYB/NQK/URP` буквами):

```
| 6   24   1  |
| 13  16   10 |
| 20  17   15 |
```

Поскольку `A` равно `0`, `C` равно `2`, а `T` равно `19`, сообщение является вектором:

```
|  0  |
|  2  |
|  19 |
```

Таким образом, зашифрованный вектор задается формулой:

```
| 6   24   1  |  |  0  |   |  67  |   |  15 |
| 13  16   10 |  |  2  | = |  222 | ≡ |  14 | (mod 26)
| 20  17   15 |  |  19 |   |  319 |   |  7  |
```

что соответствует зашифрованному тексту `POH`.

Теперь предположим, что наше сообщение вместо этого `CAT` (обратите внимание, что здесь мы используем те же буквы, что и в `ACT`), или:

```
|  2  |
|  0  |
|  19 |
```

На этот раз зашифрованный вектор задается формулой:

```
| 6   24   1  |  |  2  |   |  31  |   |  5  |
| 13  16   10 |  |  0  | = |  216 | ≡ |  8  | (mod 26)
| 20  17   15 |  |  19 |   |  325 |   |  13 |
```

который соответствует зашифрованному тексту `FIN`. Каждая буква была изменена.

## Расшифровка

Для расшифровки сообщения каждый блок умножается на величину, обратную матрице, используемой для шифрования. Мы преобразуем зашифрованный текст обратно в вектор, а затем просто умножаем на обратную матрицу ключевой матрицы (`IFK/VIV/VMI` буквами). (Смотрите [обращение матрицы](https://en.wikipedia.org/wiki/Matrix_inversion) о методах вычисления обратной матрицы.) Мы находим, что по модулю 26 обратная матрица, используемая в предыдущем примере, равна:

```
                -1
| 6   24   1  |                | 8   5    10 |
| 13  16   10 |    (mod 26) ≡  | 21  8    21 |
| 20  17   15 |                | 21  12   8  |
```

Взяв предыдущий пример зашифрованного текста `POH`, мы получаем:

```
| 8   5    10 |  |  15 |   |  260 |   |  0  |
| 21  8    21 |  |  14 | = |  574 | ≡ |  2  | (mod 26)
| 21  12   8  |  |  7  |   |  539 |   |  19 |
```

что возвращает нас к `ACT`, как и ожидалось.

## Определение матрицы шифрования

При выборе матрицы шифрования возникают две сложности:

1. Не все матрицы имеют обратное значение. Матрица будет иметь обратное значение тогда и только тогда, когда ее [определитель](https://en.wikipedia.org/wiki/Determinant) не равен нулю.
2. Определитель шифрующей матрицы не должен иметь каких-либо общих множителей с модульной базой.

Таким образом, если мы работаем по модулю `26`, как указано выше, определитель должен быть отличным от нуля и не должен делиться на `2` или `13`. Если определитель равен `0` или имеет общие множители с модульной базой, то матрица не может быть использована в шифре Хилла, и необходимо выбрать другую матрицу (в противном случае ее невозможно будет расшифровать). К счастью, матрицы, которые удовлетворяют условиям, используемым в шифре Хилла, довольно распространены.

## Ссылки

- [Шифр Хилла в Википедии](https://en.wikipedia.org/wiki/Hill_cipher)
- [Инверсия матрицы на MathIsFun](https://www.mathsisfun.com/algebra/matrix-inverse.html)
- [GeeksForGeeks](https://www.geeksforgeeks.org/hill-cipher/)

